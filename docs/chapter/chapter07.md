[TOC]

# 题目
1. 查询没有学全所有课程的同学的信息



# 解释

所有课程的数量：

```mysql
mysql> SELECT Count(*) FROM Course;
+----------+
| Count(*) |
+----------+
|        3 |
+----------+
1 row in set (0.00 sec)

```

通过SC表统计小于3的同学

```mysql
mysql> SELECT SId,COUNT(CId) AS countcid FROM SC GROUP BY SId HAVING countcid < 3;
+------+----------+
| SId  | countcid |
+------+----------+
| 05   |        2 |
| 06   |        2 |
| 07   |        2 |
+------+----------+
3 rows in set (0.00 sec)
```

然后与学生表做笛卡儿积（这种方法会漏掉一门都没有选的同学）

```mysql
mysql> SELECT * FROM Student INNER JOIN (SELECT SId,COUNT(CId) AS countcid FROM SC GROUP BY SId HAVING countcid < (SELECT Count(*) FROM Course)) AS biao1 ON Student.SId = biao1.SId;
+------+--------+---------------------+------+------+----------+
| SId  | Sname  | Sage                | Ssex | SId  | countcid |
+------+--------+---------------------+------+------+----------+
| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 05   |        2 |
| 06   | 吴兰   | 1992-03-01 00:00:00 | 女   | 06   |        2 |
| 07   | 郑竹   | 1989-07-01 00:00:00 | 女   | 07   |        2 |
+------+--------+---------------------+------+------+----------+
3 rows in set (0.00 sec)
```

方法二：

先得到一张笛卡儿积的表

```mysql
mysql> SELECT Student.*,SC.CId FROM Student LEFT JOIN SC on Student.SId=SC.SId;
+------+--------+---------------------+------+------+
| SId  | Sname  | Sage                | Ssex | CId  |
+------+--------+---------------------+------+------+
| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   | 01   |
| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   | 02   |
| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   | 03   |
| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 01   |
| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 02   |
| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 03   |
| 03   | 孙风   | 1990-05-20 00:00:00 | 男   | 01   |
| 03   | 孙风   | 1990-05-20 00:00:00 | 男   | 02   |
| 03   | 孙风   | 1990-05-20 00:00:00 | 男   | 03   |
| 04   | 李云   | 1990-08-06 00:00:00 | 男   | 01   |
| 04   | 李云   | 1990-08-06 00:00:00 | 男   | 02   |
| 04   | 李云   | 1990-08-06 00:00:00 | 男   | 03   |
| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 01   |
| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 02   |
| 06   | 吴兰   | 1992-03-01 00:00:00 | 女   | 01   |
| 06   | 吴兰   | 1992-03-01 00:00:00 | 女   | 03   |
| 07   | 郑竹   | 1989-07-01 00:00:00 | 女   | 02   |
| 07   | 郑竹   | 1989-07-01 00:00:00 | 女   | 03   |
| 09   | 张三   | 2017-12-20 00:00:00 | 女   | NULL |
| 10   | 李四   | 2017-12-25 00:00:00 | 女   | NULL |
| 11   | 李四   | 2017-12-30 00:00:00 | 女   | NULL |
| 12   | 赵六   | 2017-01-01 00:00:00 | 女   | NULL |
| 13   | 孙七   | 2018-01-01 00:00:00 | 女   | NULL |
+------+--------+---------------------+------+------+
23 rows in set (0.00 sec)
```

然后通过GROUP BY 和 HAVING得到低于3们课程的同学

```mysql
mysql> SELECT biao1.SId, COUNT(biao1.CId) AS countsid FROM (SELECT Student.*,SC.CId FROM Student LEFT JOIN SC on Student.SId=SC.SId) AS biao1 GROUP BY biao1.SId HAVING countsid < (SELECT Count(*) FROM Course);
+------+----------+
| SId  | countsid |
+------+----------+
| 05   |        2 |
| 06   |        2 |
| 07   |        2 |
| 09   |        0 |
| 10   |        0 |
| 11   |        0 |
| 12   |        0 |
| 13   |        0 |
+------+----------+
8 rows in set (0.00 sec)
```

最后再与学生表合并信息

```mysql
mysql> SELECT Student.*,biao2.countsid FROM Student JOIN (SELECT biao1.SId, COUNT(biao1.CId) AS countsid FROM (SELECT Student.*,SC.CId FROM Student LEFT JOIN SC on Student.SId=SC.SId) AS biao1 GROUP BY biao1.SId HAVING countsid < (SELECT Count(*) FROM Course)) AS biao2 ON Student.SId = biao2.SId;
+------+--------+---------------------+------+----------+
| SId  | Sname  | Sage                | Ssex | countsid |
+------+--------+---------------------+------+----------+
| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |        2 |
| 06   | 吴兰   | 1992-03-01 00:00:00 | 女   |        2 |
| 07   | 郑竹   | 1989-07-01 00:00:00 | 女   |        2 |
| 09   | 张三   | 2017-12-20 00:00:00 | 女   |        0 |
| 10   | 李四   | 2017-12-25 00:00:00 | 女   |        0 |
| 11   | 李四   | 2017-12-30 00:00:00 | 女   |        0 |
| 12   | 赵六   | 2017-01-01 00:00:00 | 女   |        0 |
| 13   | 孙七   | 2018-01-01 00:00:00 | 女   |        0 |
+------+--------+---------------------+------+----------+
8 rows in set (0.00 sec)
```

# 总结

